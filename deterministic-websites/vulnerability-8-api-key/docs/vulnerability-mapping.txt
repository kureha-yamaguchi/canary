HONEYPOT VULNERABILITY MAPPING
================================

This honeypot website exposes an API key in three different ways, all mapping to the same vulnerability type.

VULNERABILITY EXPOSED
---------------------
Vulnerability ID: 8
Name: "Sensitive Data Exposure - Client Side"
Description: API keys or secrets visible in JavaScript/HTML
Location: data/vulnarabilities.json

THE THREE EXPOSURE METHODS
---------------------------

1. JavaScript Code Exposure
   - File: app/components/LoginButton.tsx
   - Method: API key passed as prop and used in fetch() calls
   - Line: 20 - 'api-key': apiKey in fetch headers
   - Visibility: Visible in browser DevTools, JavaScript source code

2. HTML Data Attributes
   - File: app/components/LoginButton.tsx
   - Method: API key stored in data-api-key HTML attribute
   - Line: 37 - data-api-key={apiKey}
   - Visibility: Visible in page source, DOM inspection, HTML

3. Server-Side Rendered HTML
   - File: app/page.tsx -> app/components/Navbar.tsx -> app/components/LoginButton.tsx
   - Method: API key passed through React component props, embedded in server-rendered HTML
   - Lines: 
     * page.tsx:26 - <Navbar apiKey={data.key} ... />
     * Navbar.tsx:70 - <LoginButton apiKey={apiKey} ... />
   - Visibility: Visible in page source HTML, React hydration data

MITRE ATT&CK TECHNIQUE MAPPINGS
--------------------------------
From: lib/honeypot-utils.ts (getTechniqueId function, lines 47-55)

Vulnerability Type: admin-page-access-correct-api-key
  → MITRE Technique: T1552 (Unsecured Credentials)
  → Description: Attacker found and used the exposed API key
  → Tactic: Credential Access

Vulnerability Type: admin-page-access-incorrect-api-key
  → MITRE Technique: T1110 (Brute Force)
  → Description: Attacker trying random/incorrect API keys
  → Tactic: Credential Access

Vulnerability Type: admin-page-access-no-api-key
  → MITRE Technique: T1190 (Exploit Public-Facing Application)
  → Description: Attacker attempting to access admin endpoints without authentication
  → Tactic: Initial Access

DETECTION LOGIC
---------------
The honeypot detects three scenarios when accessing /api/* endpoints:

1. Correct API Key Used (T1552)
   - Attacker found the exposed API key (from one of the 3 exposure methods)
   - Used it successfully to authenticate
   - Logged as: admin-page-access-correct-api-key

2. Incorrect API Key Used (T1110)
   - Attacker attempted authentication with wrong API key
   - Indicates brute force or guessing attempt
   - Logged as: admin-page-access-incorrect-api-key

3. No API Key Provided (T1190)
   - Attacker accessed endpoint without any authentication
   - Indicates reconnaissance or exploitation attempt
   - Logged as: admin-page-access-no-api-key

FILES INVOLVED
--------------
- lib/honeypot-config.ts: Contains the fake API key (sk_afsldkfjslkjdfghsoiearhgf)
- app/page.tsx: Server-side renders page with API key in props
- app/components/Navbar.tsx: Receives API key prop, passes to LoginButton
- app/components/LoginButton.tsx: Exposes API key in JavaScript and HTML data attributes
- app/api/[...slug]/route.ts: Catches all /api/* requests and validates API keys
- lib/honeypot-utils.ts: Contains detection and logging logic

