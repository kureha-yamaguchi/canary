export const getVulnerabilityFromPath = (path: string): string => {
  const normalizedPath = path.toLowerCase();

  // phpMyAdmin
  if (
    normalizedPath.includes('phpmyadmin') ||
    normalizedPath.includes('pma') ||
    normalizedPath.includes('myadmin') ||
    normalizedPath.includes('mysql') ||
    normalizedPath.includes('mysqladmin') ||
    normalizedPath.includes('sql/admin') ||
    normalizedPath.includes('db/admin') ||
    normalizedPath.includes('dbadmin') ||
    normalizedPath.includes('admin/db')
  ) {
    return 'active-scanning-phpmyadmin';
  }

  // WordPress
  if (
    normalizedPath.includes('wp-admin') ||
    normalizedPath.includes('wp-login') ||
    normalizedPath.includes('wp-content') ||
    normalizedPath.includes('wp-includes') ||
    normalizedPath.includes('wordpress') ||
    normalizedPath.includes('wp-config') ||
    normalizedPath.includes('wp-json') ||
    normalizedPath.includes('xmlrpc.php')
  ) {
    return 'active-scanning-wordpress';
  }

  // Git exposure
  if (
    normalizedPath.includes('/.git') ||
    normalizedPath.includes('.git/config') ||
    normalizedPath.includes('.git/head') ||
    normalizedPath.includes('.git/index') ||
    normalizedPath.includes('.gitignore')
  ) {
    return 'active-scanning-git';
  }

  // Environment files
  if (
    normalizedPath === '/.env' ||
    normalizedPath === '/.env.local' ||
    normalizedPath === '/.env.production' ||
    normalizedPath === '/.env.development' ||
    normalizedPath === '/.env.backup' ||
    normalizedPath === '/env' ||
    normalizedPath === '/.env.example'
  ) {
    return 'active-scanning-env';
  }

  // Joomla
  if (
    normalizedPath.includes('/administrator') ||
    normalizedPath.includes('joomla') ||
    normalizedPath.includes('/components/com_') ||
    normalizedPath.includes('configuration.php')
  ) {
    return 'active-scanning-joomla';
  }

  // Drupal
  if (
    normalizedPath.includes('drupal') ||
    normalizedPath.includes('/user/login') ||
    normalizedPath.includes('/admin/config') ||
    normalizedPath.includes('sites/default/files')
  ) {
    return 'active-scanning-drupal';
  }

  // Admin panels (generic)
  if (
    normalizedPath === '/admin' ||
    normalizedPath === '/admin/' ||
    normalizedPath === '/admin/login' ||
    normalizedPath === '/administrator' ||
    normalizedPath === '/admin/index.php' ||
    normalizedPath === '/admin/admin.php' ||
    normalizedPath === '/admin/home.php' ||
    normalizedPath === '/administrator/index.php' ||
    normalizedPath === '/admin/controlpanel' ||
    normalizedPath === '/admin/cp' ||
    normalizedPath === '/cp' ||
    normalizedPath === '/modx/manager/' ||
    normalizedPath === '/manager/html' ||
    normalizedPath === '/admin_area' ||
    normalizedPath === '/panel' ||
    normalizedPath === '/controlpanel' ||
    normalizedPath === '/adminpanel' ||
    normalizedPath === '/admin1' ||
    normalizedPath === '/admin2'
  ) {
    return 'active-scanning-admin';
  }

  // Backup files
  if (
    normalizedPath.includes('.backup') ||
    normalizedPath.includes('.bak') ||
    normalizedPath.includes('.old') ||
    normalizedPath.includes('.orig') ||
    normalizedPath.includes('.save') ||
    normalizedPath.includes('.sql.gz') ||
    normalizedPath.includes('.tar.gz') ||
    normalizedPath.includes('.zip') ||
    normalizedPath.includes('/backup') ||
    normalizedPath.includes('/backups') ||
    normalizedPath.includes('database.sql')
  ) {
    return 'active-scanning-backups';
  }

  // Config files
  if (
    normalizedPath.includes('config.php') ||
    normalizedPath.includes('configuration.php') ||
    normalizedPath.includes('config.inc.php') ||
    normalizedPath.includes('config.json') ||
    normalizedPath.includes('settings.php') ||
    normalizedPath.includes('web.config') ||
    normalizedPath.includes('app.config') ||
    normalizedPath.includes('/config/')
  ) {
    return 'active-scanning-config';
  }

  // Server info / debug files
  if (
    normalizedPath === '/phpinfo.php' ||
    normalizedPath === '/info.php' ||
    normalizedPath === '/test.php' ||
    normalizedPath === '/server-status' ||
    normalizedPath === '/server-info' ||
    normalizedPath === '/.htaccess' ||
    normalizedPath === '/debug' ||
    normalizedPath === '/trace.axd'
  ) {
    return 'active-scanning-debug';
  }

  // Shell / webshell
  if (
    normalizedPath.includes('shell.php') ||
    normalizedPath.includes('c99.php') ||
    normalizedPath.includes('r57.php') ||
    normalizedPath.includes('c100.php') ||
    normalizedPath.includes('webshell') ||
    normalizedPath.includes('backdoor')
  ) {
    return 'active-scanning-shell';
  }

  // AWS / Cloud metadata
  if (
    normalizedPath.includes('/latest/meta-data') ||
    normalizedPath.includes('169.254.169.254') ||
    normalizedPath.includes('/metadata')
  ) {
    return 'active-scanning-cloud-metadata';
  }

  // API endpoints
  if (
    normalizedPath === '/api' ||
    normalizedPath === '/api/' ||
    normalizedPath.startsWith('/api/v1') ||
    normalizedPath.startsWith('/api/v2') ||
    normalizedPath === '/graphql' ||
    normalizedPath === '/swagger' ||
    normalizedPath === '/api-docs'
  ) {
    return 'active-scanning-api';
  }

  // Solr / Elasticsearch
  if (
    normalizedPath.includes('/solr') ||
    normalizedPath.includes('/elasticsearch') ||
    normalizedPath.includes(':9200')
  ) {
    return 'active-scanning-search-engines';
  }

  // Jenkins
  if (
    normalizedPath.includes('/jenkins') ||
    normalizedPath.includes(':8080/jenkins')
  ) {
    return 'active-scanning-jenkins';
  }

  // Docker
  if (
    normalizedPath.includes('/docker') ||
    normalizedPath.includes(':2375') ||
    normalizedPath.includes(':2376')
  ) {
    return 'active-scanning-docker';
  }

  // cPanel / Plesk / Webmin
  if (
    normalizedPath.includes('/cpanel') ||
    normalizedPath.includes(':2082') ||
    normalizedPath.includes(':2083') ||
    normalizedPath.includes('/plesk') ||
    normalizedPath.includes('/webmin') ||
    normalizedPath.includes(':10000')
  ) {
    return 'active-scanning-hosting-panels';
  }

  // Logs
  if (
    normalizedPath.includes('.log') ||
    normalizedPath.includes('/logs/') ||
    normalizedPath.includes('/log/') ||
    normalizedPath.includes('error_log') ||
    normalizedPath.includes('access_log')
  ) {
    return 'active-scanning-logs';
  }

  // Magento
  if (
    normalizedPath.includes('/magento') ||
    normalizedPath.includes('/admin_') ||
    normalizedPath.includes('/downloader')
  ) {
    return 'active-scanning-magento';
  }

  // Laravel
  if (
    normalizedPath.includes('/telescope') ||
    normalizedPath.includes('/horizon') ||
    normalizedPath.includes('/.env.example')
  ) {
    return 'active-scanning-laravel';
  }

  // Symfony
  if (
    normalizedPath.includes('/_profiler') ||
    normalizedPath.includes('/_wdt') ||
    normalizedPath.includes('app_dev.php')
  ) {
    return 'active-scanning-symfony';
  }

  // Tomcat
  if (
    normalizedPath.includes('/manager/html') ||
    normalizedPath.includes('/manager/text') ||
    normalizedPath.includes('/host-manager')
  ) {
    return 'active-scanning-tomcat';
  }

  // Adminer
  if (normalizedPath.includes('adminer')) {
    return 'active-scanning-adminer';
  }

  // Credentials / keys
  if (
    normalizedPath.includes('id_rsa') ||
    normalizedPath.includes('id_dsa') ||
    normalizedPath.includes('.pem') ||
    normalizedPath.includes('privatekey') ||
    normalizedPath.includes('.key')
  ) {
    return 'active-scanning-credentials';
  }

  // Struts exploits (CVE-2017-5638)
  if (normalizedPath.includes('struts')) {
    return 'active-scanning-struts';
  }

  // Spring Boot
  if (
    normalizedPath.includes('/actuator') ||
    normalizedPath.includes('/env') ||
    normalizedPath.includes('/health') ||
    normalizedPath.includes('/metrics')
  ) {
    return 'active-scanning-spring-boot';
  }

  // Telerik
  if (normalizedPath.includes('telerik')) {
    return 'active-scanning-telerik';
  }

  // Common exploits
  if (
    normalizedPath.includes('elfinder') ||
    normalizedPath.includes('fckeditor') ||
    normalizedPath.includes('ckeditor') ||
    normalizedPath.includes('tinymce')
  ) {
    return 'active-scanning-file-managers';
  }

  // Fallback
  return 'active-scanning-other';
};
