{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 4, "column": 0}, "map": {"version":3,"sources":["file:///Users/shayyahal/canary/deterministic-websites/users-managment/components/UserTracker.tsx"],"sourcesContent":["'use client';\n\nimport { useEffect } from 'react';\nimport { usePathname, useSearchParams } from 'next/navigation';\n\nexport default function UserTracker() {\n  const pathname = usePathname();\n  const searchParams = useSearchParams();\n\n  useEffect(() => {\n    // Track page views\n    trackEvent('page_view', {\n      path: pathname,\n      search: searchParams.toString(),\n    });\n  }, [pathname, searchParams]);\n\n  useEffect(() => {\n    // Single event listener for ALL interactions\n    const trackInteraction = (e: Event) => {\n      const target = e.target as HTMLElement;\n\n      // Get element details\n      const data: any = {\n        type: e.type,\n        tagName: target.tagName,\n        id: target.id,\n        className: target.className,\n        text: target.textContent?.slice(0, 100), // First 100 chars\n        timestamp: Date.now(),\n        path: pathname,\n      };\n\n      // Capture data attributes (for custom tracking)\n      Object.keys(target.dataset).forEach(key => {\n        data[`data_${key}`] = target.dataset[key];\n      });\n\n      // Form-specific data\n      if (target.tagName === 'INPUT' || target.tagName === 'TEXTAREA') {\n        data.inputType = (target as HTMLInputElement).type;\n        data.inputName = (target as HTMLInputElement).name;\n        // Don't log actual values for privacy\n      }\n\n      // Button/link specific\n      if (target.tagName === 'BUTTON' || target.tagName === 'A') {\n        data.href = (target as HTMLAnchorElement).href;\n      }\n\n      trackEvent(`user_${e.type}`, data);\n    };\n\n    // Listen to multiple event types\n    const events = ['click', 'submit', 'change', 'focus', 'input'];\n    events.forEach(eventType => {\n      document.addEventListener(eventType, trackInteraction, true);\n    });\n\n    // Track mouse movement (sampled)\n    let lastMouseTrack = 0;\n    const trackMouse = (e: MouseEvent) => {\n      const now = Date.now();\n      if (now - lastMouseTrack > 1000) { // Sample every second\n        trackEvent('mouse_position', {\n          x: e.clientX,\n          y: e.clientY,\n          path: pathname,\n        });\n        lastMouseTrack = now;\n      }\n    };\n    document.addEventListener('mousemove', trackMouse);\n\n    // Track scroll depth\n    let maxScroll = 0;\n    const trackScroll = () => {\n      const scrollHeight = document.body.scrollHeight - window.innerHeight;\n      if (scrollHeight <= 0) return; // Avoid division by zero\n\n      const scrollPercent = Math.round(\n        (window.scrollY / scrollHeight) * 100\n      );\n      if (scrollPercent > maxScroll) {\n        maxScroll = scrollPercent;\n        trackEvent('scroll_depth', { depth: scrollPercent, path: pathname });\n      }\n    };\n    window.addEventListener('scroll', trackScroll);\n\n    // Cleanup\n    return () => {\n      events.forEach(eventType => {\n        document.removeEventListener(eventType, trackInteraction, true);\n      });\n      document.removeEventListener('mousemove', trackMouse);\n      window.removeEventListener('scroll', trackScroll);\n    };\n  }, [pathname]);\n\n  return null;\n}\n\n// Helper to send events to Supabase\nasync function trackEvent(event: string, data: any) {\n  try {\n    await fetch('/api/track', {\n      method: 'POST',\n      headers: { 'Content-Type': 'application/json' },\n      body: JSON.stringify({\n        event,\n        data,\n        session_id: getSessionId(),\n        user_id: getUserId(), // If you have auth\n        timestamp: new Date().toISOString(),\n      }),\n    });\n  } catch (error) {\n    console.error('Tracking failed:', error);\n  }\n}\n\nfunction getSessionId() {\n  let sessionId = sessionStorage.getItem('session_id');\n  if (!sessionId) {\n    sessionId = crypto.randomUUID();\n    sessionStorage.setItem('session_id', sessionId);\n  }\n  return sessionId;\n}\n\nfunction getUserId() {\n  // Get from localStorage if user is logged in\n  return localStorage.getItem('user_id') || null;\n}\n"],"names":[],"mappings":"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"}},
    {"offset": {"line": 176, "column": 0}, "map": {"version":3,"sources":["file:///Users/shayyahal/canary/deterministic-websites/users-managment/node_modules/next/navigation.js"],"sourcesContent":["module.exports = require('./dist/client/components/navigation')\n"],"names":[],"mappings":"AAAA,OAAO,OAAO","ignoreList":[0]}}]
}